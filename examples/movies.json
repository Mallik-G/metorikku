{
  "steps": [
    {
      "sql": "SELECT userId, movies.movieId, rating, timestamp, title, genres from ratings join movies on ratings.movieId = movies.movieId",
      "dataFrameName": "moviesWithRatings"
    },
    {
      "sql": "SELECT topic,count(*) as count FROM inputStream group by topic",
      "dataFrameName": "inputStream"
    }
  ],
  "output": [
    {
      "dataFrameName": "inputStream",
      "outputType": "Parquet",
      "outputOptions": {
        "saveMode": "Overwrite",
        "path": "moviesWithRatings.parquet"
      }
    }
  ]
}
